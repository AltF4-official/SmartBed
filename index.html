<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SmartBed</title>
  <style>
    :root {
      --bg: #0F0F0F;
      --fg: #0000FF;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body, html {
      width: 100%; height: 100%;
      font-family: sans-serif;
      background: var(--bg);
      color: var(--fg);
      transition: background 0.3s, color 0.3s;
    }
    #app { display: flex; flex-direction: column; height: 100%; }
    .header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px;
    }
    .header .icon { font-size: 1.5rem; }
    .header h2 { font-size: 1.25rem; }
    .header button {
      background: none; border: none; font-size: 1.25rem;
      color: var(--fg); cursor: pointer;
    }
    .center {
      flex: 1; display: flex; align-items: center; justify-content: center;
    }
    .power-button {
      font-size: 5rem; color: gray; border: none; background: none;
      cursor: pointer; transition: color 0.2s;
    }
    .power-on { color: var(--fg); }
    .controls { padding: 16px; }
    .hidden { display: none; }
    .brightness {
      display: flex; align-items: center; gap: 8px;
      margin-bottom: 16px;
    }
    .brightness button {
      border: none; background: none;
      font-size: 1.25rem; color: var(--fg); cursor: pointer;
    }
    .brightness input[type=range] { flex: 1; }
    .flash-controls button {
      margin-right: 8px; padding: 8px 12px; font-size: 1rem;
      border: 2px solid var(--fg); border-radius: 8px;
      background: none; color: var(--fg); cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .flash-on { background: var(--fg); color: var(--bg); }
    .modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      display: flex; align-items: center; justify-content: center;
    }
    .modal-content {
      background: var(--bg); padding: 24px; border-radius: 12px;
      border: 1px solid var(--fg); width: 90%; max-width: 320px;
    }
    .modal-content h3 { margin-bottom: 12px; }
    .modal-content label {
      display: block; margin: 8px 0;
      font-size: 0.95rem;
    }
    .modal-content input[type=number],
    .modal-content input[type=color],
    .modal-content select {
      width: 100%; padding: 6px; margin-top: 4px;
      border: 1px solid var(--fg); border-radius: 4px;
      background: none; color: var(--fg);
    }
    .modal-actions {
      display: flex; justify-content: space-between; margin-top: 16px;
    }
    .modal-actions button {
      flex: 1; margin: 0 4px; padding: 8px;
      border: none; border-radius: 6px; cursor: pointer;
    }
    .error { color: #f33; font-size: 0.9rem; margin-top: 8px; }
    .notification {
      position: fixed; bottom: 30px; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8); color: #fff;
      padding: 12px; border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="header">
      <span class="icon">üõèÔ∏è</span>
      <h2>SmartBed</h2>
      <button id="settings-btn">‚öôÔ∏è</button>
    </div>

    <div class="center">
      <button id="power-btn" class="power-button">‚èª</button>
    </div>

    <div id="controls" class="controls hidden">
      <div id="brightness-control" class="brightness">
        <button id="minus-bright">‚òÄÔ∏è‚Äì</button>
        <input type="range" id="brightness" min="0" max="35" value="35">
        <button id="plus-bright">‚òÄÔ∏è+</button>
        <div id="brightness-label">100%</div>
      </div>
      <div class="flash-controls">
        <button id="flash-toggle">Flash Mode</button>
        <button id="flash-settings-btn" class="hidden">‚öôÔ∏è</button>
      </div>
    </div>

    <!-- Flash settings modal -->
    <div id="flash-modal" class="modal hidden">
      <div class="modal-content">
        <h3>Flash Settings</h3>
        <label>On (ms):
          <input type="number" id="flash-on" value="100" min="10" max="10000">
        </label>
        <label>Off (ms):
          <input type="number" id="flash-off" value="100" min="10" max="10000">
        </label>
        <div class="modal-actions">
          <button id="flash-cancel">Cancel</button>
          <button id="flash-apply">Apply</button>
        </div>
        <div id="flash-error" class="error hidden">
          Enter valid values 10‚Äì10000 ms.
        </div>
      </div>
    </div>

    <!-- Settings modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <h3>Theme Settings</h3>
        <label>
          Theme:
          <select id="theme-select"></select>
        </label>
        <div id="custom-colors" class="hidden">
          <label>Primary:
            <input type="color" id="custom-primary" value="#0000ff">
          </label>
          <label>Secondary:
            <input type="color" id="custom-secondary" value="#ffffff">
          </label>
          <div id="color-error" class="error hidden">
            Colors too similar.
          </div>
        </div>
        <button id="settings-close" style="margin-top:16px; width:100%; padding:8px; border:none; border-radius:6px; cursor:pointer; background:var(--fg); color:var(--bg);">
          Close
        </button>
      </div>
    </div>

    <div id="notification" class="notification hidden"></div>
  </div>

  <script>
    const themes = [
      { name: "Electric Blue & Dark Gray", bg: "#0F0F0F", fg: "#0000FF" },
      { name: "Baby Blue & Dark Gray",    bg: "#0F0F0F", fg: "#B3E6FF" },
      { name: "Bubblegum Pink & White",    bg: "#FFFFFF", fg: "#FF66B3" },
      { name: "Forest Green & Dark Gray",  bg: "#0F0F0F", fg: "#008000" },
      { name: "Gold & Dark Gray",          bg: "#0F0F0F", fg: "#FFFF00" },
      { name: "Cherry & Dark Gray",        bg: "#0F0F0F", fg: "#FF0000" },
      { name: "Soft Lilac & White",        bg: "#FFFFFF", fg: "#CCB3FF" },
      { name: "Custom",                    bg: "#0000FF", fg: "#FFFFFF", custom: true }
    ];

    const state = {
      isOn: false,
      brightness: 35,
      flashMode: false,
      flashOn: 100,
      flashOff: 100,
      selectedTheme: themes[0]
    };

    const root  = document.documentElement;
    const powerBtn          = document.getElementById("power-btn");
    const controls          = document.getElementById("controls");
    const brightnessInput   = document.getElementById("brightness");
    const brightnessLabel   = document.getElementById("brightness-label");
    const minusBtn          = document.getElementById("minus-bright");
    const plusBtn           = document.getElementById("plus-bright");
    const flashToggle       = document.getElementById("flash-toggle");
    const flashSettingsBtn  = document.getElementById("flash-settings-btn");
    const flashModal        = document.getElementById("flash-modal");
    const flashOnInput      = document.getElementById("flash-on");
    const flashOffInput     = document.getElementById("flash-off");
    const flashApply        = document.getElementById("flash-apply");
    const flashCancel       = document.getElementById("flash-cancel");
    const flashError        = document.getElementById("flash-error");
    const settingsBtn       = document.getElementById("settings-btn");
    const settingsModal     = document.getElementById("settings-modal");
    const themeSelect       = document.getElementById("theme-select");
    const customColors      = document.getElementById("custom-colors");
    const customPrimary     = document.getElementById("custom-primary");
    const customSecondary   = document.getElementById("custom-secondary");
    const colorError        = document.getElementById("color-error");
    const closeSettings     = document.getElementById("settings-close");
    const notification      = document.getElementById("notification");

    // --- Theme & Notification ---
    function applyTheme() {
      const t = state.selectedTheme;
      root.style.setProperty('--bg', t.bg);
      root.style.setProperty('--fg', t.fg);
    }
    function showNotification(msg) {
      notification.textContent = msg;
      notification.classList.remove('hidden');
      setTimeout(() => notification.classList.add('hidden'), 4000);
    }

    // --- Power Toggle ---
    powerBtn.addEventListener('click', () => {
      state.isOn = !state.isOn;
      controls.classList.toggle('hidden', !state.isOn);
      powerBtn.classList.toggle('power-on', state.isOn);
    });

    // --- Brightness Controls ---
    function updateBrightness() {
      const pct = Math.round((state.brightness / 35) * 100);
      brightnessLabel.textContent = pct + '%';
    }
    minusBtn.addEventListener('click', () => {
      state.brightness = Math.max(0, state.brightness - 1);
      brightnessInput.value = state.brightness;
      updateBrightness();
    });
    plusBtn.addEventListener('click', () => {
      state.brightness = Math.min(35, state.brightness + 1);
      brightnessInput.value = state.brightness;
      updateBrightness();
    });
    brightnessInput.addEventListener('input', () => {
      state.brightness = Number(brightnessInput.value);
      updateBrightness();
    });

    // --- Flash Mode & Settings ---
    flashToggle.addEventListener('click', () => {
      state.flashMode = !state.flashMode;
      flashToggle.classList.toggle('flash-on', state.flashMode);
      flashSettingsBtn.classList.toggle('hidden', !state.flashMode);
    });
    flashSettingsBtn.addEventListener('click', () => flashModal.classList.remove('hidden'));
    flashCancel.addEventListener('click', () => flashModal.classList.add('hidden'));
    flashApply.addEventListener('click', () => {
      const on  = Number(flashOnInput.value);
      const off = Number(flashOffInput.value);
      if (isNaN(on) || isNaN(off) || on < 10 || on > 10000 || off < 10 || off > 10000) {
        flashError.classList.remove('hidden');
        showNotification("Enter valid numbers.");
      } else {
        state.flashOn  = on;
        state.flashOff = off;
        flashError.classList.add('hidden');
        flashModal.classList.add('hidden');
      }
    });

    // --- Theme Selection & Custom Colors ---
    themes.forEach((t,i) => {
      const opt = new Option(t.name, i);
      themeSelect.add(opt);
    });
    themeSelect.addEventListener('change', e => {
      state.selectedTheme = themes[e.target.value];
      customColors.classList.toggle('hidden', !state.selectedTheme.custom);
      applyTheme();
    });
    function pickColor() {
      const fg = customPrimary.value;
      const bg = customSecondary.value;
      // simple contrast check
      const dr = Math.abs(parseInt(fg.substr(1,2),16) - parseInt(bg.substr(1,2),16));
      const dg = Math.abs(parseInt(fg.substr(3,2),16) - parseInt(bg.substr(3,2),16));
      const db = Math.abs(parseInt(fg.substr(5,2),16) - parseInt(bg.substr(5,2),16));
      const tooClose = dr<25&&dg<25&&db<25;
      colorError.classList.toggle('hidden', !tooClose);
      state.selectedTheme.bg = fg;
      state.selectedTheme.fg = bg;
      applyTheme();
    }
    customPrimary.addEventListener('input', pickColor);
    customSecondary.addEventListener('input', pickColor);

    // --- Settings Modal ---
    settingsBtn.addEventListener('click', () => settingsModal.classList.remove('hidden'));
    closeSettings.addEventListener('click', () => settingsModal.classList.add('hidden'));

    // --- Initialize ---
    applyTheme();
    updateBrightness();
  </script>
</body>
</html>
